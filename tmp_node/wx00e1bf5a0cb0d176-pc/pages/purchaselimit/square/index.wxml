<view class="fixedTopBorder"></view>
<view class="container" wx:if="{{!otherSuccessFlag}}">
    <form bindsubmit="{{paymentPlugShow?'onPay':'onOrderSubmit'}}" reportSubmit="true">
        <view class="pickuptype" style="display:{{showPickupType?'flex':'none'}}" wx:if="{{munblock}}">
            <view class="chooseWay" wx:if="{{showEnableExpress}}">
                <view bindtap="changePickupType" class="pickuptype-item {{pickupType===1?'active':''}}" data-type="1">
          物流配送
        </view>
            </view>
            <view class="chooseWay" wx:if="{{showPickupType}}">
                <view bindtap="changePickupType" class="pickuptype-item {{pickupType===2?'active':''}}" data-type="2">
          到店自提
        </view>
            </view>
        </view>
        <view class="addrinfo {{pickupType==3?'border1px':''}}" wx:if="{{pickupType==1||pickupType==3}}">
            <image src="{{baseUrl}}/images/wxapp/line.png" style="width:100%;height:6px;display: block;"></image>
            <view bindtap="showAddrManage" wx:if="{{defaultAddr}}">
                <view class="addr-manage-header">
                    <text class="iconPlace iconfont icon-iconfont_location"></text>
                    <view class="addr-manage-content">
                        <view class="nameAndTel">
                            <text class="realName">{{defaultAddr.RealName}}</text>
                            <text class="contactNumber">{{defaultAddr.ContactNumber}}</text>
                        </view>
                        <view class="placeText placeTextWidth">{{defaultAddr.CombinedAddress}}</view>
                    </view>
                    <text class="iconfont_arrow-right icon-iconfont_arrow-right goPlace iconfont"></text>
                </view>
            </view>
            <view bindtap="showAddrManage" class="addPlace" wx:if="{{!defaultAddr}}">
                <text class="addBtn iconfont icon-jia"></text> 添加收货地址
      </view>
        </view>
        <view class="lbsinfo" wx:if="{{showPickupType&&pickupType==2}}">
            <view class="lbs-tips">
                <text class="iconfont icon-xiangqing"></text>
                <text>{{pickupInfo.ShopPickupPs}}</text>
            </view>
            <view class="formData">
                <view bindtap="changeShowLbsShop" class="pickup-shop border1px item-data">
                    <text class="titleName">取货门店</text>
                    <button bindopensetting="getOpenData" class="local-btn-box" openType="openSetting" wx:if="{{!selectStoreFlag}}"></button>
                    <view class="rightSelect">
                        <view class="{{LbsShopName?'textColor':''}}">
              {{LbsShopName?LbsShopName:'选择门店'}}
            </view>
                        <text class="iconfont icon-iconfont_arrow-right"></text>
                    </view>
                </view>
                <view bindtap="showTimeSelector" class="pickup-time item-data">
                    <text class="titleName">取货时间</text>
                    <view class="rightSelect">
                        <view class="{{PickupTime?'textColor':''}}">
              {{PickupTime?PickupTime:'选择时间'}}
            </view>
                        <text class="iconfont icon-iconfont_arrow-right"></text>
                    </view>
                </view>
            </view>
            <view style="height:20rpx;background:#f4f4f4"></view>
            <view class="formData">
                <view class="item-data border1px">
                    <text class="titleName">真实姓名：</text>
                    <view class="rightSelect">
                        <input bindinput="inputUserName" class="input-contact" name="Contact" placeholder="请输入真实姓名" style="display: {{showSuccessPlug?'none':'block'}}" type="text" value="{{NickName}}"></input>
                    </view>
                </view>
                <view class="item-data">
                    <text class="titleName">取货人手机号码：</text>
                    <view class="rightSelect">
                        <input bindinput="inputUserMobile" class="input-mobile" maxlength="11" name="Mobile" placeholder="请输入取货人手机号码" style="display: {{showSuccessPlug?'none':'block'}}" type="number" value="{{Mobile}}"></input>
                    </view>
                </view>
            </view>
        </view>
        <view style="height:20rpx;background:#f4f4f4"></view>
        <view catchtap="closemask" class="lbsshop-mask" style="display:{{showLbsShop?'block':'none'}}"></view>
        <view class="lbsshop-ctnr" style="display:{{showLbsShop?'block':'none'}}">
            <view class="lbsshop-title">选择门店</view>
            <view class="meidian" wx:if="{{lbsList.length==0}}">
                <image class="img" src="{{baseUrl}}/images/wxapp/blank_23.png"></image>
                <view class="nomendiantext">暂无取货门店哦~</view>
            </view>
            <scroll-view bindscrolltolower="onlbsListScroll" lowerThreshold="50" scrollY="true" style="max-height: 726rpx;" wx:if="{{lbsList.length>0}}">
                <radio-group name="LbsID">
                    <label bindtap="onLbsShopChange" class="lbsshop-item" data-lbsid="{{item.Id}}" data-lbsidx="-1" data-lbsname="{{item.Name}}" wx:for="{{lbsList}}" wx:key="Id">
                        <view class="lbsshop-radio-ctnr">
                            <radio checked="{{item.Name===LbsShopName}}" class="lbsradio" color="#ff7200" type="radio" value="{{item.Id}}"></radio>
                            <icon class="iconText" color="{{item.Name===LbsShopName?'#ff7200':'#ddd'}}" size="20" type="{{item.Name===LbsShopName?'success':'circle'}}"></icon>
                        </view>
                        <view class="lbsshop-info-ctnr">
                            <view class="lbsshop-top">
                                <view class="lbsshop-name">{{item.Name}}</view>
                                <view class="distance" wx:if="{{item.distance!=NAN}}">
                                    <text>{{item.distance>1?item.distance:item.distance*1000}}</text>
                                    <text>{{item.distance>1?'km':'m'}}</text>
                                </view>
                            </view>
                            <view class="lbsshop-addr">
                                <text class="iconfont icon-dizhi"></text>
                                <text class="address">{{item.Address}}</text>
                            </view>
                            <view class="lbsshop-foot">
                                <view class="lbsshop-tpl">
                                    <text class="iconfont icon-nbbPhone1"></text>
                                    <text>{{item.Mobile}}</text>
                                </view>
                                <view catchtap="location" class="checkmap" data-item="{{item}}">
                                    <text class="iconfont icon-iconfont_location"></text>
                                    <text>查看地图</text>
                                </view>
                            </view>
                        </view>
                    </label>
                </radio-group>
            </scroll-view>
        </view>
        <include src="/components/picker_datetime.wxml"></include>
        <view class="product-list border1px">
            <view class="product-item">
                <view class="col1">
                    <image class="image" mode="aspectFit" src="{{baseUrl}}{{squareInfo.images}}"></image>
                </view>
                <view class="col2">
                    <view class="name">{{squareInfo.name}}</view>
                    <view class="norms">
                        <text class="two">{{skuStr}}</text>
                        <view class="itemNum">x{{num}}</view>
                    </view>
                    <view class="price">￥{{msPrice}}</view>
                </view>
            </view>
        </view>
        <view class="memoinfo border1px">
            <text class="memoinfoTitle">买家留言：</text>
            <textarea autoHeight="true" class="memo" disabled="{{showLbsShop||textareaFlag||showSuccessPlug||paymentPlugShow||showTimeChoose||otherSuccessFlag}}" name="Memo" placeholder="请输入你的留言..." placeholderStyle="color:{{showLbsShop||textareaFlag||showSuccessPlug||paymentPlugShow||showTimeChoose||otherSuccessFlag?'transparent':'#999'}}" style="opacity:{{showLbsShop||textareaFlag||showSuccessPlug||paymentPlugShow||showTimeChoose||otherSuccessFlag?0:1}};color:{{showLbsShop||textareaFlag||showSuccessPlug||paymentPlugShow||showTimeChoose||otherSuccessFlag?'transparent':'#333'}};display:{{showLbsShop||textareaFlag||showSuccessPlug||paymentPlugShow||showTimeChoose||otherSuccessFlag?'none':'block'}};"></textarea>
        </view>
        <view class="freightinfo border1px" style="display:{{defaultAddr&&pickupType!=2?'flex':'none'}};font-size:26rpx">
            <text>快递运费</text>
            <text>￥{{freight}}</text>
        </view>
        <view class="subtotal">
            <text class="subtotalnum">共{{num}}件商品，小计：</text>
            <text class="allMoney">￥{{productSubtotal}}</text>
        </view>
        <view class="suminfo" style="display:{{hasproduct?'flex':'none'}}; ">
            <view class="suminfo-desc">
        合计：
        <text class="total-money">￥{{TotalMoney}}</text>
            </view>
            <text class="sendOderText">提交订单</text>
            <view class="suminfo-submit">
                <button class="sendOrder" formType="submit"></button>
            </view>
        </view>
        <include src="/pages/common/paymenttype.wxml"></include>
    </form>
    <view class="successPlug" wx:if="{{showSuccessPlug}}">
        <view class="successPlugContent">
            <view class="successIconBox">
                <text class="icon-gou iconfont"></text>
            </view>
            <view class="success-title">已完成付款</view>
            <view class="success-desc">请耐心期待宝贝的到来</view>
            <view bindtap="goOrderdetail" class="success-orderdetail">查看订单</view>
        </view>
    </view>
</view>
<view style="height:98rpx;"></view>
<include src="/pages/common/paymentresult.wxml"></include>
<template is="footnav" data="{{pageurl:pageurl}}" wx:if="{{!showAddrManage}}"></template>
